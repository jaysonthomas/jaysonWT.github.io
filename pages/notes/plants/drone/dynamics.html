
<!DOCTYPE html>
<html>
<head>
  <title>Drone dynamics</title>
  <meta name="Drone dynamics" content="text/html; charset=utf-8;" />
  <script type="text/javascript" src="../../../../logbook.js"></script>

  <script src="../../../../logbook-mathjax-config.js" defer></script> 
  <script type="text/javascript" id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/atom-one-light.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <link rel="stylesheet" type="text/css" href="../../../../logbook.css" />
</head>

<body onload="loadChapter('');">  

  <div data-type="titlepage" pdf="no">
    <header>
      <h1><a href="../../../../index.html" style="text-decoration:none;">Logbook</a></h1>
      <p style="font-size: 18px;"><a href="../../../../pages/bio/jjwt.html">Jayson Wynne-Thomas</a></p>
      <p style="font-size: 14px; text-align: right;"> 
        Last modified <span id="last_modified"></span>.</br>
        <script>
        var d = new Date(document.lastModified);
        document.getElementById("last_modified").innerHTML = d.getFullYear() + "-" + (d.getMonth()+1) + "-" + d.getDate();</script>
      </p>
    </header>
  </div>
  
  <div id="main" class="sidebar1">
    <span style="font-size:10px;cursor:pointer" onclick="openNav()">&#9776;</span>
  </div>

  <div id="mySidenav" class="sidebar">
  
<a href="#0">Forces acting on a drone</a>
<ul class="no-bullets">
  <li><a href="#0.0">Thrust and gravity</a></li>
  <li><a href="#0.1">Drag</a></li>
</ul>
<a href="#1">Moments</a>
<a href="#2">Equilibrium (Balanced forces)</a>
<ul class="no-bullets">
  <li><a href="#2.0">Translational equilibrium</a></li>
  <li><a href="#2.1">Rotational equilibrium</a></li>
</ul>
<a href="#3">The rotors</a>
<ul class="no-bullets">
  <li><a href="#3.0">Forces and Moments</a></li>
  <li><a href="#3.1">Lift constants</a></li>
  <li><a href="#3.2">Example 1</a></li>
  <li><a href="#3.3">Example 2</a></li>
</ul>
<a href="#4">Advancing the state of the vehicle</a>
<ul class="no-bullets">
  <li><a href="#4.0">Functions to write</a></li>
  <li><a href="#4.1">Figure out the state variables</a></li>
  <li><a href="#4.2">Plots</a></li>
</ul>
</div>

<chapter style="counter-reset: chapter 0"><h1>Drone dynamics</h1>

<section id="0"><h1>Forces acting on a drone</h1>
  <subsection id="0.0"><h1>Thrust and gravity</h1>
     <i>Thrust</i> is the upward force generated by each of the rotors as they spin through air. <i>Weight</i> is the force due to gravity. To hover, a quadrotor exerts an overall thrust force upwards which is equal in size to the force that gravity exerts downwards.

     <p>
      Considering the thrust vectors:
      <ul>
        <li>
          The strength/magnitude depends on the size and shape of the rotor's plates and on how fast they spin.
        </li>
  
        <li>
          The direction is always perpendicular to the plane that the rotor is spins in.
        </li>
       </ul>
     </p>
     
    <div class="container">
      <figure>
        <img style="height:50px; width:auto"
        src="../../../../figures/drone/30_thrust.png"/>
        <figcaption>
          Direction of thrust
        </figcaption>
      </figure>
    </div>

    <subsubsection id="3.0"><h1>Linear translational acceleration</h1>
      Considering a monorotor, it has only one rotor and therefore only one thrust vector. If the thrust vector is in the vertical $z$ direction, then the z component of force will cause an acceleration in the z direction:

      $$
        F_z = m\ddot{z}
      $$

      <div class="container">
        <figure>
          <img style="height:100px; width:auto"
          src="../../../../figures/drone/32_translationalAccel.png"/>
          <figcaption>
            In the example, the net force on the monorotor with a mass of 2kg would be $23.6-19.6 = 4N$, causing an acceleration of $2m/s^2$. 
          </figcaption>
        </figure>
      </div>
    </subsubsection>
  </subsection>

  <subsection id="0.1"><h1>Drag</h1>
    A quadrotor as a whole and the individual propellers experience drag.

    <p>
      In practice, drag is treated as a disturbance when designing quadrotor controllers. It isn't modeled explicitly as:
      <ul>
        <li>
          Its effects are relatively small at lower vehicle and wind speeds
        </li>
        <li>
          It is difficult to identify the correct drag model
        </li>
      </ul>
    </p>
  </subsection>
</section>

<section id="1"><h1>Moments</h1>
  [<a href="https://t.ly/i02K">Monorotor spinning sim video</a>] <br>
  In addition to causing a thrust force, a rotating propeller also introduces a <i>moment</i> or <i>torque</i>. A rotor that's spinning clockwise will produce a moment that causes the body to spin counter-clockwise.

  <subsubsection id="3.1"><h1>Rotational acceleration</h1>
    For a three-dimensional quadrotor motion, the moment of inertia will be a $3\times 3$ matrix. It is easier to think about one axis of rotation at a time. For a monorotor where only the z-axis is considered, the torque equation would be:
     
    $$
      M_z = I_z \ddot\psi
    $$

    $\psi$ is the yaw angle.
   </subsubsection>
</section>

<section id="2"><h1>Equilibrium (Balanced forces)</h1>
  <subsection id="2.0"><h1>Translational equilibrium</h1>
    When a monorotor is hovering, it is in translational equilibrium. 

    <div class="container">
      <figure>
        <img style="height:100px; width:auto"
        src="../../../../figures/drone/31_ex1_monorotor.png"/>
        <figcaption>
          If the monorotor is hovering, then $F_{thrust} = 100N$. From the balance of forces, the mass would be: $m = \frac{100}{9.8} = ~10.2kg$ which is a big monorotor.
        </figcaption>
      </figure>
    </div>
    
    It's impossible for a monorotor to sit truly motionless in the sky because it can never be in rotational equilibrium. 
  </subsection>

  <subsection id="2.1"><h1>Rotational equilibrium</h1>
    In a quadrotor, the propellers are placed in a configuration where adjacent rotors always spin in the opposite directions - whilst all rotors provide an upward thrust, one set rotates clockwise and the other CCW. 
    
    <p>
      A drone has no rotation or yaw when all its rotors are spinning at the same rate such that CW torques exactly balance the CCW torques. When the clockwise rotors spin faster than the CCW ones, the CCW moment produced by those clockwise rotors dominates, and the drone will yaw in the CCW direction.
    </p>
  </subsection>
</section>

<section id="3"><h1>The rotors</h1>
  <subsection id="3.0"><h1>Forces and Moments</h1>
    Moment and force produced by each spinning rotor:

    $$\begin{gather*}
      F &\propto &\omega^2 \\
      &=& k_f \omega^2 \\

      M &\propto &\omega^2 \\
      &=& k_m \omega^2
    \end{gather*}$$
    
    $\omega$ represents the rotation rate of a rotor in $\frac{rad}{s}$. When $\omega = 2\pi$, the rotor does one rotation per second. For a rotation rate of $\omega$, the thrust produced and the moment induced are both proportional to $\omega^2$.
  </subsection>

  <subsection id="3.1"><h1>Lift constants</h1>
    The constants of proportionality, $k_f$ is the <i>thrust coefficient</i>, and $k_m$ is the <i>angular torque coefficient</i>. The actual values of these constants depend on:
    <ul>
      <li>the size and shape of the plates</li>
      <li>the specific motors used</li>
      <li>the density of the surrounding air they operate in</li>
    </ul> 
    
    In practice, we obtain these values empirically. We mount the motor and propeller on a load cell and measure the force and moment for different motor speeds. The graph below shows a simulation of the data you might get from such an experiment.

    <div class="container">
      <figure>
        <img style="height:150px; width:auto"
        src="../../../../figures/drone/33_liftConstants.png"/>
        <figcaption>
          Lift constants empirical data
        </figcaption>
      </figure>
    </div>
    
    Based on the Force vs $\omega$ graph shown above, the $k_f$ for the particular propeller is 0.007. If we double the rotation speed of a rotor, the thrust increases by a factor of 4.
  </subsection>

  <p></p>
  <button class="accordion">Examples</button>
  <div class="panel">
  <subsection id="3.2"><h1>Example 1</h1>
      A co-axial helicopter is just a body with two rotors on top of each other which produce upward thrusts by spinning in opposite directions. Let rotor 1 spin CW with $\omega_1$ and rotor 2 spin CCW with $\omega_2$. Find $\ddot{z}$ and $\ddot\psi$.

      <p>
        Mass, $m = 1.0kg$ <br>
        Moment of inertia, $I_z = 2.0kgm^2$<br>
        Force constant of proportionality, $k_f = 0.1$<br>
        Moment constant of proportionality, $k_m = 0.2$<br>
        Rotation rate of propeller 1, $\omega_1 = 10.0rad/s$<br>
        Rotation rate of propeller 2, $\omega_2 = 8.0rad/s$
      </p>

      Resulting vertical linear acceleration:
      $$\begin{align*}
        \ddot{z} &= \frac{F_{net}}{m} \\
              &= \frac{1}{m}(mg - F_{thrust}) \\
              &= \frac{1}{m}(mg - k_f(\omega_1^2 + \omega_2^2)) \\
              &= g - \frac{k_f}{m}(\omega_1^2 + \omega_2^2) \\
              &= -6.6 m/s^2
      \end{align*}$$

      <p>
        Resulting rotational/angular acceleration:
        $$\begin{align*}
        \ddot{\psi} &= \frac{M_{z}}{I_z} \\
              &= \frac{k_m}{I_z}(\omega_2^2 - \omega_1^2) \\
              &= -3.6 rad/s^2
      \end{align*}$$
      </p>

      If rotor 1 (top) spins faster than rotor 2, then the body of the vehicle experiences angular acceleration in the CCW direction! The body and the propeller would be spinning in opposite directions to each other. Both $\ddot{z}$ and $\ddot\psi$ are along the z axis. $\omega_1^2$ is given a negative sign because we only consider the reaction torque similar to the direction of the thrust - we expel air downwards but consider the motion in the opposite direction. The positive z axis points downwards. When we curl, the thumb points in the positive z direction.
    </subsection>

  <subsection id="3.3"><h1>Example 2</h1>
      What thrust would a 2.2 kg monorotor need in order to accelerate upwards at -4.0m/s2 (remember, z is positive downwards)? 30.4N
    </subsection>
  </div>
</section>

<section id="4"><h1>Advancing the state of the vehicle</h1>
  When we are able to implement a function that advances the state of a vehicle forward in time, it means we understand how all the forces impact the motion of the vehicle, i.e. the dynamics of the system. 

  <subsection id="4.0"><h1>Functions to write</h1>
    Write the function in 2 stages:
    <ul>
      <li>Uncontrolled motion</li>
      The rotors aren't spinning and the vehicle is purely under the influence of gravity in this case.

      <p>
        <li>Controlled motion</li>
      </p>
    </ul>
  </subsection>

  <subsection id="4.1"><h1>Figure out the state variables</h1>
    Forces directly affect the acceleration of the system. The question is: what accelerations does the system experience? How do these effect the system.

    <p>
      Any kind of acceleration advances the state forward in time by dt seconds. It first changes the velocity which changes the position. So, these 2 variables need to be part of our state.
    </p>

    If the rotors were spinning, there would be rotational velocity and angle included in the state variables. To keep track of state in 3D, there would be 3*4 (since there are 4 for the 1D case) variables/equations.
  </subsection>

  <subsection id="4.2"><h1>Plots</h1>
    Plot position/velocity vs time curve! Refer advance_state_uncontrolled_0.
  </subsection>
</section>
</chapter>

</body>
</html>
