
<!DOCTYPE html>
<html>
<head>
  <title>Drone dynamics</title>
  <meta name="Drone dynamics" content="text/html; charset=utf-8;" />
  <script type="text/javascript" src="../../../logbook.js"></script>

  <script src="../../../logbook-mathjax-config.js" defer></script> 
  <script type="text/javascript" id="MathJax-script" defer
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/atom-one-light.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <link rel="stylesheet" type="text/css" href="../../../logbook.css" />
</head>

<body onload="loadChapter('');">  

  <div data-type="titlepage" pdf="no">
    <header>
      <h1><a href="../../../index.html" style="text-decoration:none;">Logbook</a></h1>
      <p style="font-size: 18px;"><a href="../../../bio/jjwt.html">Jayson Wynne-Thomas</a></p>
      <p style="font-size: 14px; text-align: right;"> 
        Last modified <span id="last_modified"></span>.</br>
        <script>
        var d = new Date(document.lastModified);
        document.getElementById("last_modified").innerHTML = d.getFullYear() + "-" + (d.getMonth()+1) + "-" + d.getDate();</script>
      </p>
    </header>
  </div>

  <table style="width:100%;" pdf="no"><tr style="width:100%">
    <td style="width:33%;text-align:left;">
      <a class="previous_chapter" href="">Prev Chapter</a>
    </td>
    
    <td style="width:33%;text-align:center;">
      <a href="">Root Chapter</a>
    </td>
    
    <td style="width:33%;text-align:right;">
      <a class="next_chapter" href="">Next Chapter</a>
    </td>
  </tr></table>
  
  <div id="main" class="sidebar1">
    <span style="font-size:10px;cursor:pointer" onclick="openNav()">&#9776;</span>
  </div>

  <div id="mySidenav" class="sidebar">
  
<a href="#0">Table of Contents</a>
<a href="#1">Overview</a>
</div>

<chapter style="counter-reset: chapter 0"><h1>Drone dynamics</h1>

<section id="0"><h1>Table of Contents</h1>
  <ul>
    <li><a href="#1">Overview</a></li>
    <li><a href="pid.html">Control</a></li>
    <li><a href="#3">Musings</a></li>
    <li><a href="full3DControl.html">Full 3D control</a></li>
  </ul>
</section>

<section id="1"><h1>Overview</h1>
  From a control standpoint, having a good dynamics model of a vehicle allows us to intelligently influence the output of the vehicle by properly setting the inputs. For a drone, the input would be the rotation rates of the four propellers and the output would be the resulting motion of the vehicle. 

  <p>
    <i>Dynamics</i> is concerned with the motion of bodies under the action of forces. For a drone, understanding the dynamics involves understanding:
    <ul>
      <li>How the rotation of the drone's four propellers creates forces</li>
      <li>How these forces generate motion of the vehicle</li>
    </ul>
  </p>

  The aim is to:
  <ul>
    <li>Understand the forces acting on a drone and how they affect motion</li>
    <li>Implement a mathematical model of these forces in python</li>
    <li>Use the model to advance the current state of the vehicle</li>
  </ul>

  A <i>force</i> is just a push or a pull on an object. It is a vector that has both a magnitude and a direction. A spinning rotor produces thrust and moments. At equilibrium, forces and moments all balance each other out and sum to zero. We get some form of acceleration when forces do not balance. 
</section>

<section><h1>Forces acting on a drone</h1>
  <subsection><h1>Thrust and gravity</h1>
    To hover, a quadrotor exerts an overall force upwards which is equal in size to the force that gravity exerts downwards. <i>Thrust</i> is the upward force generated by each of the rotors as they spin through air. <i>Weight</i> is the force due to gravity.

    <subsubsection><h1>Magnitude and direction of gravity</h1>
      For gravity, the force always points straight downwards toward the centre of the earth. The strength of the force is given by:
      $$
        mg
      $$
      $m$ is the mass of the quadrotor. $g$ is the acceleration due to gravity, which is $~9.81 m/s^2$. This is the rate at which an object will accelerate downwards when it's dropped on earth.

      <div class="container">
        <figure>
          <img style="height:60px; width:auto"
          src="../../../figures/drone/29_gravity.png"/>
          <figcaption>
            Direction of gravity
          </figcaption>
        </figure>
      </div>
    </subsubsection>

    <subsubsection><h1>Magnitude and direction of thrust</h1>
      The strengths of the thrust vectors depend on the size and shape of the rotor's plates and on how fast they are spinning. The direction of a rotor's thrust vector is always perpendicular to the plane that the rotor is spinning in. When we control a quadrotor, all we actually get is to control the magnitude of these four thrust vectors.

      <div class="container">
        <figure>
          <img style="height:50px; width:auto"
          src="../../../figures/drone/30_thrust.png"/>
          <figcaption>
            Direction of thrust
          </figcaption>
        </figure>
      </div>
    </subsubsection>
  </subsection>

  <subsection><h1>Drag</h1>
    <i>Drag</i> is a friction force (due to air resistance) caused by the motion of a body through a fluid such as air. For example, the quadrotor experiences a drag force because of the difference in velocity between the vehicle body and the air. And there's even drag related to each propeller's individual motion. 

    <p>
      In practice, we usually treat drag as a disturbance when designing quadrotor controllers, and don't model it explicitly as the effects are relatively small at lower vehicle and wind speeds and because it's difficult to identify the correct drag model. 
    </p>
  </subsection>
</section>

<section><h1>Moments</h1>
  In a quadrotor,one set of rotor plates provide upward thrust when spinning clockwise and the other type provide upward thrust when spinning counter-clockwise. These propellers are placed in a configuration where adjacent rotors always spin in the opposite directions. A drone has zero rotation or yaw when all its rotors are spinning at the same rate such that CW torques exactly balance the CCW torques. The rotors that spin clockwise, introduce a CCW moment, and vice versa. When the clockwise rotors spin faster than the CCW ones, the CCW moment produced by those clockwise rotors will dominate, and the drone will yaw in the CCW direction.
</section>

<section><h1>Equilibrium</h1>
  Let's take the example of a monorotor hovering.

  <subsection><h1>Translational equilibrium</h1>
    A monorotor has only one rotor, which means there's only one thrust vector. When a monorotor is hovering, it's in a state called <i>translational equilibrium</i> i.e. it's not experiencing any translational acceleration. A translation is any non-rotational motion. So, zero translational acceleration means an object isn't accelerating towards the left or right, up or down and forward or backward. The only way an object can be in translational equilibrium is if the net force on the object is 0.

    <div class="container">
      <figure>
        <img style="height:60px; width:auto"
        src="../../../figures/drone/31_ex1_monorotor.png"/>
        <figcaption>
          Calculate the mass and the thrust?
        </figcaption>
      </figure>
    </div>
    
    If the weight vector of a monorotor is 100 newtons down, then if it's hovering, the thrust must be 100 newtons up. Mass = $\frac{100}{9.8}$ = $~10.2kg$ -> pretty big quadrotor. 
    
    It's impossible for a monorotor to sit truly motionless in the sky because it can never be in rotational equilibrium. 
  </subsection>

  <subsection><h1>Rotational equilibrium</h1>
    Where does the rotation of the monorotor body come from? In addition to causing a thrust force, a rotating propeller also introduces a <i>moment</i> or <i>torque</i>. A rotor that's spinning clockwise will produce a moment that causes the body to spin counter-clockwise. When we design a flying aircraft, we generally don't want the spinning behaviour. 
  </subsection>
</section>

<section><h1>Acceleration</h1>
  <subsection><h1>Linear translational acceleration</h1>
    Unbalanced forces cause acceleration. When an object experiences an unbalanced force, it accelerates in the direction of the net force.

    $$
      F = ma
    $$
    $F$ is the net force acting on the object. $a$ is acceleration measured in an inertial frame, i.e. a reference frame that is not accelerating, like the world frame. $F$ and $a$ are vectors and can be analysed on a pure direction basis. So, if we look in the vertical direction for a monorotor, then the z component of force will cause an acceleration in the z direction:

    $$
      F_z = m\ddot{z}
    $$

    <div class="container">
      <figure>
        <img style="height:80px; width:auto"
        src="../../../figures/drone/32_translationalAccel.png"/>
        <figcaption>
          If a monorotor with a mass of 2kg has these forces acting on it, the net force would be 23.6-19.6, or 4N. This would cause an acceleration of 2$m/s^2$. 
        </figcaption>
      </figure>
    </div>

  </subsection>

  <subsection><h1>Rotational acceleration</h1>
    Unbalanced moments cause rotational acceleration. The equation that relates these quantities:

    $$
      \tau = I \alpha
    $$
    
    $\tau$ is the net torque [used interchangeably with moment] around a given axis. $\alpha$ [$\frac{rad}{sec^2}$] is the angular acceleration about the same axis; it gives an indication of how fast the rotational speed is changing. Both are vectors.
    
    <p>
      $I$ is the <i>Moment of Inertia</i>. It is a measure of how hard it is to change an object's rotational velocity about a particular axis. It can be different for each axis. To describe the three-dimensional quadrotor motion, the moment of inertia will be a $3\times 3$ matrix.
    </p>

    It is easier to think about one axis of rotation at a time. In the world of quadrotor dynamics, people tend to use the word moment over torque. Greek letter psi is used to represent yaw. So, another way to write the torque equation is like this (since it's a monorotor, we only consider the z-axis):
    
    $$
      M_z = I_z \ddot\psi
    $$
  </subsection>
</section>

<section><h1>The rotors</h1>
  <subsection><h1>Forces and Moments</h1>
    What are the magnitudes of the moments and forces that the spinning rotors produce?  

    $$\begin{gather*}
      F &\propto &\omega^2 \\
      &=& k_f \omega^2 \\

      M &\propto &\omega^2 \\
      &=& k_m \omega^2
    \end{gather*}$$
    
    $\omega$ represents the rotation rate of a rotor in $\frac{rad}{s}$. When $\omega = 2\pi$, the rotor is doing one rotation per second. It turns out that when a rotor spins for the rotation rate of $\omega$, the thrust produced and the induced moment are both proportional to $\omega^2$.
  </subsection>

  <subsection><h1>Lift constants</h1>
    The constants of proportionality, $k_f$ is the <i>thrust coefficient</i>, and $k_m$ is the <i>angular torque coefficient</i>. The actual values of these constants depend on:
    <ul>
      <li>the size and shape of the plates</li>
      <li>the specific motors used</li>
      <li>the density of the surrounding air they operate in</li>
    </ul> 
    
    In practice, we obtain these values empirically. We mount the motor and propeller on a load cell and measure the force and moment for different motor speeds. The graph below shows a simulation of the data you might get from such an experiment.

    <div class="container">
      <figure>
        <img style="height:150px; width:auto"
        src="../../../figures/drone/33_liftConstants.png"/>
        <figcaption>
          Lift constants empirical data
        </figcaption>
      </figure>
    </div>
    
    Based on the Force vs $\omega$ graph shown above, the $k_f$ for the particular propeller is 0.007. If we double the rotation speed of a rotor, the thrust increases by a factor of 4.
  </subsection>

  <subsection><h1>Example</h1>
    A co-axial helicopter is just a body with two rotors on top of each other which produce upward thrusts by spinning in opposite directions. Let rotor 1 spin CW with $\omega_1$ and rotor 2 spin CCW with $\omega_2$.

    <p>
      Mass, $m = 1.0kg$ <br>
      Moment of inertia, $I_z = 2.0$
    </p>

  </subsection>
</section>

</chapter>

</body>
</html>
